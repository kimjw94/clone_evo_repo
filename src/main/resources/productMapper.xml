<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.market.evo.product.ProductMapper">

	<!-- categoryName -->
	<select id="categoryList" resultType="map">
		select * from evo_category
	</select>

	<!-- detailCategoryName -->
	<select id="detailCateList" parameterType="int" resultType="map">
		select d_category_detail_code, d_category_detail_name
		from
		evo_category_detail
		where d_category_code = #{c_category_code}
	</select>

	<!-- 상품 추가 -->
	<insert id="addProduct"
		parameterType="com.market.evo.product.Product">
		insert into evo_product
		values (
		seq_p_product_no.nextval,
		#{p_product_name},
		#{p_m_id},
		#{p_category_code},
		#{p_price},
		#{p_info},
		#{p_photo},
		default,
		default,
		default
		)
	</insert>

	<!-- 상품 이미지 추가 -->
	<insert id="addImage" parameterType="map">
		insert into
		evo_product_image
		values(
		#{im_p_product_no},
		#{im_thumbnail_image},
		#{im_info_image}
		)
	</insert>

	<!-- 상품 번호 불러오는거 -->
	<select id="getProNo" parameterType="com.market.evo.product.Product" resultType="int">
		select p_product_no
		from evo_product
		where p_addDay = (select max(p_addDay) from (
		select p_addDay
		from evo_product
		where p_product_name = #{p_product_name}
		and p_m_id = #{p_m_id}
		and p_category_code = #{p_category_code}))
	</select>

	<select id="idViewProduct" parameterType="String"
		resultType="map">
		select p_view, p_price, p_product_name, p_product_no
		from evo_product
		where p_m_id = #{p_m_id}
	</select>
	<!--상의라는 카테고리에 포함되는 상품정보,상품이미지 가져오기 -->
	<select id="getProductsUpperWearWithImage" resultType="map">
		select
		p.*, I.IM_THUMBNAIL_IMAGE
		from evo_product p join evo_category_detail d
		on p.p_category_code = d.d_category_detail_code
		join evo_category c on
		c.c_category_code = d.d_category_code
		join evo_product_image i on
		p.p_product_no = i.im_p_product_no
		where p.p_category_code =
		d.d_category_detail_code
		and d.d_category_code = c.c_category_code
		and
		c.c_category_name= #{categoryName}
	</select>



</mapper>